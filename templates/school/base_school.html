<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>{% block title %}EduConnect ERP{% endblock %}</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

/* ================= GLOBAL ================= */
body{
    background:#f4f6fb;
    font-family: Inter, system-ui, -apple-system;
    overflow-x:hidden;
}

/* ================= SIDEBAR ================= */
.sidebar{
    height:100vh;
    background:linear-gradient(180deg,#0f172a,#1e293b);
    color:#fff;
    position:fixed;
    width:240px;
    transition:all .3s;
    overflow-y:auto;
}

.sidebar h4{
    font-weight:600;
    padding:20px;
    border-bottom:1px solid rgba(255,255,255,.1);
}

.sidebar a{
    display:flex;
    align-items:center;
    gap:10px;
    padding:12px 20px;
    color:#cbd5e1;
    text-decoration:none;
    transition:.25s;
    font-size:.95rem;
}

.sidebar a:hover{
    background:rgba(255,255,255,.08);
    padding-left:26px;
    color:#fff;
}

.sidebar a.active{
    background:rgba(59,130,246,.2);
    border-left:4px solid #3b82f6;
    color:#fff;
}

/* ================= MAIN AREA ================= */
.main-wrapper{
    margin-left:240px;
    transition:.3s;
}

/* ================= TOPBAR ================= */
.topbar{
    background:#fff;
    padding:14px 25px;
    border-bottom:1px solid #e5e7eb;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.school-name{
    font-weight:600;
    color:#0f172a;
}

.user-box{
    display:flex;
    align-items:center;
    gap:15px;
}

/* ================= RESPONSIVE ================= */
@media(max-width:991px){
    .sidebar{
        left:-240px;
    }
    .sidebar.active{
        left:0;
    }
    .main-wrapper{
        margin-left:0;
    }
}

</style>
</head>

<body>

<!-- ================= SIDEBAR ================= -->
<div id="sidebar" class="sidebar">

    <h4 class="text-center">EduConnect ERP</h4>

    <!-- DASHBOARD -->
    <a href="{% url 'schools:dashboard' %}" 
       class="{% if '/schools/dashboard' in request.path %}active{% endif %}">
        <i class="bi bi-speedometer2"></i> Dashboard
    </a>

    <!-- STUDENTS -->
    <a href="{% url 'students:students_list' %}" 
       class="{% if '/students/' in request.path %}active{% endif %}">
        <i class="bi bi-people"></i> Students
    </a>

    <!-- TEACHERS -->
    <a href="{% url 'teachers:list' %}" 
       class="{% if '/teacher/' in request.path %}active{% endif %}">
        <i class="bi bi-person-badge"></i> Teachers
    </a>

    <!-- ADMISSION -->
    <a href="{% url 'admission:list' %}" 
       class="{% if '/admission/' in request.path %}active{% endif %}">
        <i class="bi bi-mortarboard"></i> Admission
    </a>

    <!-- FEES MENU -->
    <a data-bs-toggle="collapse" href="#feesMenu"
       class="{% if '/fees/' in request.path %}active{% endif %}">
        <i class="bi bi-cash-stack"></i> Fees
    </a>

    <div class="collapse ps-3 {% if '/fees/' in request.path %}show{% endif %}" id="feesMenu">

        <a href="{% url 'fees:fees_dashboard' %}">
            Fees Dashboard
        </a>

        <a href="{% url 'fees:defaulters_report' %}">
            Defaulters
        </a>

        <a href="{% url 'schools:export-fees-excel' %}">
            Export Excel
        </a>

        <a href="{% url 'schools:export-fees-pdf' %}">
            Export PDF
        </a>

    </div>

    <!-- ATTENDANCE MENU -->
    <a data-bs-toggle="collapse" href="#attendanceMenu"
       class="{% if '/attendance/' in request.path %}active{% endif %}">
        <i class="bi bi-check-circle"></i> Attendance
    </a>

    <div class="collapse ps-3 {% if '/attendance/' in request.path %}show{% endif %}" id="attendanceMenu">

        <a href="{% url 'schools:today-attendance' %}">
            Today Attendance
        </a>

        <a href="{% url 'schools:export-attendance-excel' %}">
            Export Excel
        </a>

        <a href="{% url 'schools:export-attendance-pdf' %}">
            Export PDF
        </a>

    </div>

    <!-- EXAMS -->
    <a href="{% url 'exams:list' %}" 
       class="{% if '/exams/' in request.path %}active{% endif %}">
        <i class="bi bi-clipboard-data"></i> Exams
    </a>

    <!-- LEADS -->
    <a href="{% url 'leads:list' %}" 
       class="{% if '/leads/' in request.path %}active{% endif %}">
        <i class="bi bi-graph-up"></i> Leads
    </a>

    <!-- LOGOUT -->
    <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button class="btn btn-link text-danger w-100 text-start">
            <i class="bi bi-box-arrow-right"></i> Logout
        </button>
    </form>

</div>

<!-- ================= MAIN WRAPPER ================= -->
<div class="main-wrapper">

    <!-- TOPBAR -->
    <div class="topbar">

        <div>
            <button class="btn btn-sm btn-light d-lg-none"
                    onclick="toggleSidebar()">
                <i class="bi bi-list"></i>
            </button>

            <span class="school-name ms-2">
                {{ request.user.school.name|default:"School Dashboard" }}
            </span>
        </div>

        <div class="user-box">
            <div class="position-relative">
                <i class="bi bi-bell fs-5"></i>
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    3
                </span>
            </div>
            <strong>{{ request.user }}</strong>
        </div>

    </div>

    <!-- PAGE CONTENT -->
    <div class="p-4">
        {% block content %}{% endblock %}
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
function toggleSidebar(){
    document.getElementById("sidebar").classList.toggle("active");
}
</script>

{% block extra_js %}{% endblock %}

</body>
</html>
