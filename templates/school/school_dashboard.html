{% extends "school/base_school.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}

<h3 class="fw-bold mb-3">School Admin Dashboard</h3>

<!-- ðŸ”” NOTICE BOARD -->
{% include "includes/notice_board.html" %}

<!-- ðŸ’° FEES QUICK STATS -->
<div class="mb-3">
  <strong>Paid:</strong> â‚¹ {{ fees_collected|floatformat:0 }} |
  <strong>Pending:</strong> â‚¹ {{ pending_fees_amount|floatformat:0 }} |
  <strong>Students with Dues:</strong> {{ pending_students_count }}
</div>

<!-- ===== TOP SUMMARY CARDS ===== -->
<div class="row g-4 mb-4">
  <div class="col-md-3">
    <div class="card card-stat bg-students text-center p-3">
      <h6>Total Students</h6>
      <h2>{{ total_students }}</h2>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card card-stat bg-teachers text-center p-3">
      <h6>Total Teachers</h6>
      <h2>{{ total_teachers }}</h2>
    </div>
  </div>
</div>

<!-- ===== CHARTS SECTION ===== -->
<div class="row g-4 mb-4">

  <div class="col-md-6">
    <div class="card card-stat p-4">
      <h6 class="mb-3">ðŸ“Š Class-wise Result</h6>
      <canvas id="resultChart" height="120"></canvas>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card card-stat p-4">
      <h6 class="mb-3">ðŸ“ˆ Monthly Attendance</h6>
      <canvas id="attendanceChart" height="120"></canvas>
    </div>
  </div>

</div>

/* ðŸ“Š Class-wise Result Chart */
if (document.getElementById("resultChart")) {
  new Chart(document.getElementById("resultChart"), {
    type: "bar",
    data: {
      labels: {{ result_labels|safe }},
      datasets: [{
        label: "Average Result %",
        data: {{ result_data|safe }},
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: { min: 0, max: 100 }
      }
    }
  });
}

/* ðŸ“ˆ Monthly Attendance Chart */
if (document.getElementById("attendanceChart")) {
  new Chart(document.getElementById("attendanceChart"), {
    type: "line",
    data: {
      labels: {{ attendance_labels|default:"[]"|safe }},
      datasets: [{
        label: "Attendance %",
        data: {{ attendance_data|default:"[]"|safe }},
        borderWidth: 3,
        tension: 0.4
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { min: 0, max: 100 }
      }
    }
  });
}
</script>
{% endblock %}
