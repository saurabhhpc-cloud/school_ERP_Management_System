{% extends "attendance/base.html" %}
{% block title %}Attendance Percentage{% endblock %}

{% block content %}
<!DOCTYPE html>
<html>
<head>
  <title>Attendance Percentage</title>
  <style>
    .low { background:#ffe5e5; }
    table { border-collapse:collapse; }
    th, td { border:1px solid #ccc; padding:6px; }
  </style>
</head>
<body>

<h2>Attendance Percentage</h2>

<form method="get">
  Class: <input name="class_name" value="{{ selected_class }}">
  Section: <input name="section" value="{{ selected_section }}">
  <button type="submit">Filter</button>
</form>

<table>
  <tr>
    <th>Student</th>
    <th>Class</th>
    <th>Section</th>
    <th>Present</th>
    <th>Total</th>
    <th>%</th>
  </tr>
  {% for row in data %}
  <tr class="{% if row.low %}low{% endif %}">
    <td>{{ row.student.full_name }}</td>
    <td>{{ row.student.class_name }}</td>
    <td>{{ row.student.section }}</td>
    <td>{{ row.present }}</td>
    <td>{{ row.total }}</td>
    <td>{{ row.percent }}%</td>
  </tr>
  {% empty %}
  <tr><td colspan="6">No data</td></tr>
  {% endfor %}
</table>

<p><b>Note:</b> Red rows indicate attendance below 75%.</p>

</body>
</html>


<h3 class="mb-3">Attendance Percentage</h3>

<form class="row g-2 mb-3" method="get">
  <div class="col-md-3">
    <input class="form-control" name="class_name" placeholder="Class" value="{{ selected_class }}">
  </div>
  <div class="col-md-3">
    <input class="form-control" name="section" placeholder="Section" value="{{ selected_section }}">
  </div>
  <div class="col-md-2">
    <button class="btn btn-primary w-100">Filter</button>
  </div>
</form>

<div class="card">
  <div class="card-body p-0">
    <table class="table table-striped table-hover mb-0">
      <thead class="table-dark">
        <tr>
          <th>Student</th><th>Class</th><th>Section</th>
          <th>Present</th><th>Total</th><th>%</th>
        </tr>
      </thead>
      <tbody>
        {% for row in data %}
        <tr class="{% if row.low %}table-danger{% endif %}">
          <td>{{ row.student.full_name }}</td>
          <td>{{ row.student.class_name }}</td>
          <td>{{ row.student.section }}</td>
          <td>{{ row.present }}</td>
          <td>{{ row.total }}</td>
          <td>{{ row.percent }}%</td>
        </tr>
        {% empty %}
        <tr><td colspan="6" class="text-center">No data</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<p class="mt-2"><small>Red rows indicate attendance below 75%.</small></p>
{% endblock %}
