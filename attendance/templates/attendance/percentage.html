{% extends "school/base_school.html" %}
{% block title %}Attendance Percentage{% endblock %}

{% block content %}

<!-- PAGE HEADER -->
<div class="mb-3">
  <h4>ðŸ“Š Attendance Percentage</h4>
  <p class="text-muted">Student-wise attendance analysis</p>
</div>

<!-- FILTER -->
<form method="get" class="row g-3 mb-4">
  <div class="col-md-4">
    <input type="text" name="class_name" class="form-control"
           placeholder="Class"
           value="{{ selected_class|default:'' }}">
  </div>
  <div class="col-md-4">
    <input type="text" name="section" class="form-control"
           placeholder="Section"
           value="{{ selected_section|default:'' }}">
  </div>
  <div class="col-md-4 d-grid">
    <button class="btn btn-primary">Filter</button>
  </div>
</form>

<!-- TABLE -->
<div class="card shadow-sm">
  <div class="card-body table-responsive">
    <table class="table table-bordered align-middle">
      <thead class="table-dark">
        <tr>
          <th>Student</th>
          <th>Total Days</th>
          <th>Present</th>
          <th>Attendance %</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {% for row in data %}
        <tr class="{% if row.low %}table-warning{% endif %}">
          <td>{{ row.student.name }}</td>
          <td>{{ row.total }}</td>
          <td>{{ row.present }}</td>
          <td style="width:30%">
            <div class="progress">
              <div class="progress-bar 
                {% if row.percent >= 90 %}bg-success
                {% elif row.percent >= 75 %}bg-info
                {% else %}bg-danger{% endif %}"
                role="progressbar"
                style="width: {{ row.percent }}%">
                {{ row.percent }}%
              </div>
            </div>
          </td>
          <td>
            {% if row.low %}
              <span class="badge bg-danger">âš  Low</span>
            {% else %}
              <span class="badge bg-success">OK</span>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="text-center text-muted">
            No data found
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
